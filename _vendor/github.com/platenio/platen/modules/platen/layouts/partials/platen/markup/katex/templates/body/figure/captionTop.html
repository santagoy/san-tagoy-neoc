{{- $Params            := .                                        -}}
{{- $Caption           := $Params.Caption           | safeHTML     -}}
{{- $Definition        := $Params.Definition        | safeHTML     -}}
{{- $FigureAttributes  := $Params.FigureAttributes  | safeHTMLAttr -}}
{{- $FormulaAttributes := $Params.FormulaAttributes | safeHTMLAttr -}}
{{- $FormulaOpen       := $Params.FormulaOpen       | safeHTML     -}}
{{- $FormulaClose      := $Params.FormulaClose      | safeHTML     -}}

{{- with $FigureAttributes -}}
  <figure {{ $FigureAttributes }}>
{{- else -}}
  <figure>
{{- end }}
  <figcaption>
    {{ $Caption }}
  </figcaption>
  <div {{ $FormulaAttributes }}>
    \{{ $FormulaOpen }}
      {{ $Definition }}
    \{{ $FormulaClose }}
  </div>
</figure>